import{useReducer as e,useMemo as t,useCallback as n,createElement as r}from"react";import i from"react-ssr-prepass";import{createClient as o,ssrExchange as a,dedupExchange as u,cacheExchange as l,fetchExchange as s,Provider as p}from"urql";function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var c,d=null;function v(){d=null}function h(e,t){var n="undefined"==typeof window;return!n&&d||((d=o(f({},e,{suspense:t&&(n||e.suspense)}))).toJSON=function(){return null}),d}function g(o,d){return d||(d={}),function(g){var m=Boolean((g.getInitialProps||d.ssr)&&!d.neverSuspend),q=function(i){var q=i.pageProps,y=i.urqlClient,P=i.urqlState,C=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&-1===t.indexOf(r)&&(n[r]=e[r]);return n}(i,["pageProps","urqlClient","urqlState"]),w=e((function(e){return e+1}),0),S=w[0],x=w[1],O=q&&q.urqlState||P,I=t((function(){if(y&&!S)return y;c&&"undefined"!=typeof window?S||c.restoreData(O):c=a({initialState:O,isClient:!0,staleWhileRevalidate:"undefined"!=typeof window?d.staleWhileRevalidate:void 0});var e=o(c);return e.exchanges||(e.exchanges=[u,l,c,s]),h(e,m)}),[y,O,S]),b=n((function(){v(),c=a({initialState:void 0}),x()}),[]);return r(p,{value:I},r(g,f({},C,{pageProps:q,urqlClient:I,resetUrqlClient:b})))};return q.displayName="withUrqlClient("+(g.displayName||g.name||"Component")+")",g.getLayout&&(q.getLayout=g.getLayout),(g.getInitialProps||d.ssr)&&(q.getInitialProps=function(e){try{let P=!1;function t(e){if(P)return e;function t(){return f({},y,{urqlState:v?v.extractData():void 0,urqlClient:q})}if("undefined"!=typeof window)return f({},y,{urqlClient:q});var o=f({},y,{urqlClient:q}),a=p?o:{pageProps:o};const u=function(){if(!d.neverSuspend)return Promise.resolve(i(r(n,a))).then((function(){}))}();return u&&u.then?u.then(t):t()}var n=e.AppTree,p=!!e.Component,c=p?e.ctx:e,v=a({initialState:void 0}),m=o(v,c);m.exchanges||(m.exchanges=[u,l,v,s]);var q=h(m,!d.neverSuspend);q&&(c.urqlClient=q);var y={};const C=function(){if(g.getInitialProps)return Promise.resolve(g.getInitialProps(e)).then((function(e){if(y=e,c.res&&(c.res.writableEnded||c.res.finished))return P=!0,f({},y,{urqlClient:q})}))}();return Promise.resolve(C&&C.then?C.then(t):t(C))}catch(e){return Promise.reject(e)}}),q}}export{h as initUrqlClient,g as withUrqlClient};
//# sourceMappingURL=next-urql.min.es.js.map
